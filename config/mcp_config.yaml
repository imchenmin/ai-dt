# AI-DT MCP Server Configuration
# This file provides configuration options for the MCP server

# Server settings
server:
  name: "ai-dt-prompt-generator"
  description: "AI-DT Prompt Generator for Google Test + MockCpp"
  version: "1.0.0"
  
# LLM provider configuration
llm_providers:
  # OpenAI configuration
  openai:
    enabled: true
    api_key: ${OPENAI_API_KEY}
    default_model: "gpt-3.5-turbo"
    fallback_model: "gpt-4"
    max_tokens: 4000
    temperature: 0.1
    
  # DeepSeek configuration
  deepseek:
    enabled: true
    api_key: ${DEEPSEEK_API_KEY}
    default_model: "deepseek-chat"
    max_tokens: 4000
    temperature: 0.1
    
  # Mock provider for testing
  mock:
    enabled: false
    responses_dir: "./mcp_responses"

# Context compression settings
compression:
  max_context_size: 12000  # characters
  token_aware: true
  preserve_function_body: true  # Keep full function body (no truncation)
  include_static_functions: true  # Include static function implementations
  
  # Dependency selection limits
  max_called_functions: 5
  max_macros: 4
  max_data_structures: 3
  max_dependency_definitions: 2

# Analysis settings
analysis:
  # Clang analysis settings
  clang:
    libclang_path: ${LIBCLANG_PATH:/usr/lib/llvm-10/lib/libclang.so.1}
    parse_options: "PARSE_DETAILED_PROCESSING_RECORD"
    
  # Compilation database settings
  compilation_db:
    auto_detect: true
    default_path: "compile_commands.json"
    
  # Selective parsing for large projects
  selective_parsing:
    enabled: true
    default_include_patterns: ["src/", "include/"]
    default_exclude_patterns: ["third_party/", "vendor/", "build/"]

# Logging configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "./logs/mcp_server.log"
  max_size: "10MB"
  backup_count: 5
  
  # Console logging
  console:
    enabled: true
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Security settings
security:
  # API key validation
  validate_api_keys: true
  
  # File path validation
  validate_file_paths: true
  allowed_path_prefixes:
    - "/home"
    - "/Users"
    - "/workspace"
    
  # Rate limiting
  rate_limit:
    enabled: true
    requests_per_minute: 60
    burst_limit: 10

# Performance settings
performance:
  # Connection settings
  connection_timeout: 30  # seconds
  request_timeout: 60  # seconds
  
  # Cache settings
  cache:
    enabled: true
    max_size: 1000  # items
    ttl: 300  # seconds
    
  # Concurrency settings
  max_concurrent_requests: 5
  
  # Memory management
  max_memory_usage: "512MB"

# Tool-specific settings
tools:
  generate_test_prompt:
    timeout: 120  # seconds
    max_file_size: "10MB"
    
  analyze_function_dependencies:
    timeout: 60  # seconds
    
  get_function_signature:
    timeout: 30  # seconds

# Environment-specific overrides
# These can be set via environment variables
environment:
  development:
    logging:
      level: "DEBUG"
    security:
      validate_api_keys: false
      
  production:
    logging:
      level: "WARNING"
    security:
      validate_api_keys: true

# Monitoring and metrics
monitoring:
  enabled: false
  prometheus:
    port: 9090
    path: "/metrics"
  
  # Health checks
  health_check:
    enabled: true
    interval: 30  # seconds
    
  # Performance metrics
  metrics:
    request_duration: true
    memory_usage: true
    cache_hit_rate: true

# Example project configurations
example_projects:
  # Simple C project
  simple_c:
    path: "test_projects/c"
    comp_db: "test_projects/c/compile_commands.json"
    include_patterns: ["src/"]
    
  # Complex C project
  complex_c:
    path: "test_projects/complex_c_project"
    comp_db: "test_projects/complex_c_project/compile_commands.json"
    include_patterns: ["src/", "include/"]
    exclude_patterns: ["third_party/"]

# Notes:
# - Environment variables can be used with ${VARIABLE_NAME:default_value} syntax
# - Paths are relative to the MCP server working directory
# - All size values can use units: B, KB, MB, GB
# - Time values are in seconds unless specified otherwise